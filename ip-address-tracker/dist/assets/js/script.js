const addressInput=document.querySelector(".address-input"),submitBtn=document.querySelector(".search-btn"),errorMess=document.querySelector(".error"),ipAddress=document.querySelector(".ip-address"),loc=document.querySelector(".location"),timezone=document.querySelector(".timezone"),isp=document.querySelector(".isp");let marker;const api_key="at_NV6KNutm5C29wr5oS76HFrgdWcSkH",access_token="pk.eyJ1IjoiZG5ndG52IiwiYSI6ImNrdG84djdtdjBhZGIycXFpZmdra2Z6MDkifQ.XQMa9UGWKJXDNpB9LjK3Dg",tileUrl=`https://api.mapbox.com/styles/v1/{id}/tiles/{z}/{x}/{y}?access_token=${access_token}`,attribution='<a href="https://www.openstreetmap.org/copyright">OpenStreetMap</a> | <a href="https://www.mapbox.com/">Mapbox</a>',streets=L.tileLayer(tileUrl,{id:"mapbox/streets-v11",tileSize:512,zoomOffset:-1,maxZoom:18,attribution:attribution}),light=L.tileLayer(tileUrl,{id:"mapbox/light-v10",tileSize:512,zoomOffset:-1,maxZoom:18,attribution:attribution}),satellite=L.tileLayer(tileUrl,{id:"mapbox/satellite-v9",tileSize:512,zoomOffset:-1,maxZoom:18,attribution:attribution}),baseMaps={Streets:streets,Light:light,Satellite:satellite},mymap=L.map("map",{zoomControl:!1,center:[16.075239,108.224136],zoom:13,layers:[streets]});function getMarker(e){const t=[e.location.lat,e.location.lng],r=L.icon({iconUrl:"../../../src/images/icon-location.svg",iconAnchor:[23,56]});marker&&marker.remove(),marker=L.marker(t,{icon:r}),marker.addTo(mymap),mymap.setView(t,16)}async function getDeviceAddress(){let e=await fetch("https://api.ipify.org?format=json");if(!e)throw new Error(`HTTP error! status: ${e.statusText}`);return await e.json()}async function ipTracker(e,t="ip"){try{let r="ipAddress="+e;"domain"===t&&(r=r.replace("ipAddress","domain"));let a=await fetch(`https://geo.ipify.org/api/v1?apiKey=${api_key}&${r}`);if(!a.ok)throw new Error(`Cannot fetch the data (${a.statusText})`);let i=await a.json();return ipAddress.innerHTML=i.ip,loc.innerHTML=i.location.city+", "+i.location.region+" "+i.location.postalCode,timezone.innerHTML="UTC "+i.location.timezone,isp.innerHTML=i.isp,getMarker(i),i}catch(e){errorMess.innerText="Bad Request!",errorMess.classList.add("visible"),console.log(e.message)}}function searchTracker(){let e=addressInput.value.trim();checkValidDomain(e)?(errorMess.classList.contains("visible")&&errorMess.classList.remove("visible"),ipTracker(e,"domain")):checkValidIpv4(e)||checkValidIpv6(e)?(errorMess.classList.contains("visible")&&errorMess.classList.remove("visible"),ipTracker(e)):(errorMess.innerText="Please enter a valid IP",errorMess.classList.add("visible"))}function checkValidIpv4(e){return/^(([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])\.){3}([0-9]|[1-9][0-9]|1[0-9]{2}|2[0-4][0-9]|25[0-5])$/.test(e)}function checkValidIpv6(e){return/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/.test(e)}function checkValidDomain(e){return/^(?!:\/\/)([a-zA-Z0-9-_]+\.)*[a-zA-Z0-9][a-zA-Z0-9-_]+\.[a-zA-Z]{2,11}?$/.test(e)}L.control.layers(baseMaps,"",{position:"bottomright"}).addTo(mymap),L.control.zoom({position:"bottomleft"}).addTo(mymap),getDeviceAddress().then((e=>{ipTracker(e.ip)})).catch((e=>{console.log(e.message)})),submitBtn.addEventListener("click",searchTracker),addressInput.addEventListener("keyup",(function(e){13===e.keyCode&&(e.preventDefault(),submitBtn.click())}));
//# sourceMappingURL=script.js.map